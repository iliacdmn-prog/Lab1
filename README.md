# Лабораторна робота №1

**Тема:** Робота з файлами та даними у C# (CSV/JSON/XML/XLSX, звіти DOCX/XLSX, графіки)

**Студент:** Мілецький Ілля Валерійович, КН-212

**Варіант 37 / набір даних:** Air-Quality-Index, [Kaggle](https://www.kaggle.com/datasets/dnkumars/air-quality-index)

**Дата:** 30.09.2025

---

## 1. Мета та завдання

**Мета:**  
Опанувати роботу з файлами у форматах CSV/JSON/XML/XLSX, реалізувати обробку та збереження даних через інтерфейси, навчитися будувати графіки та формувати звіти у форматах DOCX та XLSX.

**Завдання:**
- Імпорт даних із CSV/JSON/XML/XLSX.
- Обробка/валідація/агрегація.
- Експорт у всі формати (CSV/JSON/XML/XLSX).
- Генерація звітів **XLSX** та **DOCX**.
- Візуалізація (мінімум 2 графіки) зі стороннім компонентом.
- Архітектура у 3 збірках (Domain/Data/UI), діаграма класів.

---

## 2. Опис датасету

**Походження/джерело:** [Kaggle – Air Quality Index dataset](https://www.kaggle.com/datasets/dnkumars/air-quality-index)

**Структура полів:**

| Поле        | Тип    | Приклад значення     | Опис |
|-------------|--------|----------------------|------|
| Rank        | int    | 1                    | Порядковий номер міста |
| CityCountry | string | Delhi, India         | Місто + країна |
| AverageAQI  | int    | 168                  | Середній AQI |
| MonthlyData | list   | {Jan=165, Feb=160…} | Показники AQI за місяцями |

**Обсяг:** ~150 рядків, 15 стовпців (Rank, CityCountry, AverageAQI, 12 місяців).  
**Проблеми якості:** можливі пропуски у місячних значеннях, дублікати відсутні.

---

## 3. Модель предметної області

**Сутності:**
- `CityAirQuality` — місто (Rank, CityCountry, AverageAQI, MonthlyData).
- `MonthlyAQI` — показник за конкретний місяць.
- `CityAirQualityManager` — колекція міст та операції над ними.

**Зв’язки:**
- `CityAirQuality` 1..* → `MonthlyAQI`

**Діаграма класів:**

<img width="1119" height="585" alt="image" src="https://github.com/user-attachments/assets/48623d05-7d0b-42fd-8e93-02c4201be582" />

## 4. Архітектура застосунку

**Збірки/шари:**
- **Domain:** `CityAirQuality`, `MonthlyAQI`, `CityAirQualityManager`.
- **Data:** провайдери (`CsvProvider`, `JsonProvider`, `XmlProvider`, `XlsxProvider`, `TextProvider`), сервіси звітів (`DocxReportService`, `XlsxReportService`) інтерфейс (`IProvider.cs`).
- **UI:** `MainForm` (WinForms).

**Дерево:**
  /Lab1
  /Domain
  /Data
  /UI

**Залежності/NuGet:**  
- CsvHelper (CSV)
- System.Text.Json (JSON)
- EPPlus (XLSX)  
- OpenXML SDK (DOCX)  
- OxyPlot (графіки)

---

## 5. Імпорт та чистка даних

**Формати:** CSV, JSON, XML, XLSX (реалізовані через інтерфейс `IProvider`).  

**Валідація:**  
- Перевірка Rank та AverageAQI як числових значень.  
- При відсутності значення місяця — встановлення `0`.

---

## 6. Операції над даними

- **Фільтрація/пошук/сортування:** за полями Rank, City, Country, AverageAQI (>, <, =, !=, >=, <=).  
- **Редагування:** зміна даних прямо у DataGridView, збереження назад у файл.  
- **Видалення:** видалення вибраного міста з таблиці.  

---

## 7. Експорт даних

**Підтримувані формати експорту:** CSV, JSON, XML, XLSX (універсально через `IProvider`).  
**Логи:** збереження у TXT (`TextProvider`).

---

## 8. Звіти

### 8.1 XLSX-звіт
- Аркуш **Summary**: таблиця з Average, Min, Max AQI.  
- Аркуш **Charts**: стовпчикова діаграма «Average AQI by City».  

### 8.2 DOCX-звіт
- Титульна сторінка з ПІБ, групою, варіантом.  
- Опис датасету (рядки, стовпці, наявність пропусків).  
- Попередній перегляд перших 5 рядків.  

---

## 9. Візуалізація

**Компонент:** OxyPlot.  

**Реалізовано:**
- Лінійний графік (місячні значення AQI для міста).  
- Стовпчиковий графік (місячні значення AQI для міста).  
- Кругова діаграма (розподіл середнього AQI між містами країни).  

Графіки експортуються у PNG.

---

## 10. Інтерфейс користувача

**Функції:**
- Завантаження/збереження файлів.  
- Таблиця з даними міст.  
- Панель фільтрації.  
- Побудова та експорт графіків.  
- Генерація звітів (DOCX/XLSX).  
- Логування дій користувача.  

---

## 11. Перевірка продуктивності та надійності

- Тестування на файлах ~150 рядків.  
- Імпорт/експорт займає <1 секунди.  
- Побудова графіків виконується миттєво.  
- Перевірено обробку помилок: некоректні файли, відсутність даних, скасування діалогів.  

---

## 12. Контрольні питання

1. Чому обрані сутності CityAirQuality, MonthlyAQI?  
   → Вони прямо відображають структуру датасету.  
2. Де реалізована валідація?  
   → У провайдерах при читанні файлів.  
3. Як реалізовано імпорт?  
   → Через інтерфейс `IProvider` з окремими класами для кожного формату.  
4. Як обробляються помилки?  
   → Виключення `WrongProductFileFormatException` + повідомлення користувачу.  
5. Як формується звіт?  
   → Використано OpenXML (DOCX) та EPPlus (XLSX), звіт генерується з колекції міст.

---

## 13. Використання AI

- **Інструменти:** ChatGPT.  
- **Для чого:** допомога у роботі з даними різних форматів.  
- **Зміни вручну:** код писався і налагоджувався самостійно.  
- **Підтвердження:** «Усі фрагменти коду у фінальній версії я повністю розумію та можу пояснити на захисті.»

---

## 14. Висновки

У рамках роботи реалізовано застосунок для обробки даних про індекс якості повітря.  
Програма підтримує імпорт/експорт у формати CSV, JSON, XML, XLSX, дозволяє фільтрацію, редагування, побудову графіків, генерацію звітів DOCX та XLSX.
Закріплено навички роботи з **інтерфейсами, WinForms, бібліотеками OxyPlot, EPPlus, OpenXML**.  
Можливі покращення: додати більше типів графіків, інтерактивні фільтри, інтеграцію з API для актуальних даних.

---
